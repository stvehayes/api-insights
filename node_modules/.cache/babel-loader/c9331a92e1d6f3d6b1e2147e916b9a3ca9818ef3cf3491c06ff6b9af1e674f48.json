{"ast":null,"code":"import React, { useContext, useState, useCallback, useEffect } from 'react';\nimport { AutocompleteContext } from './AutocompleteContext.js';\nimport TextInput from '../TextInput/TextInput.js';\nimport { useRefObjectAsForwardedRef } from '../hooks/useRefObjectAsForwardedRef.js';\nimport useSafeTimeout from '../hooks/useSafeTimeout.js';\nfunction _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nconst AutocompleteInput = /*#__PURE__*/React.forwardRef(({\n  as: Component = TextInput,\n  onFocus,\n  onBlur,\n  onChange,\n  onKeyDown,\n  onKeyUp,\n  onKeyPress,\n  value,\n  ...props\n}, forwardedRef) => {\n  const autocompleteContext = useContext(AutocompleteContext);\n  if (autocompleteContext === null) {\n    throw new Error('AutocompleteContext returned null values');\n  }\n  const {\n    activeDescendantRef,\n    autocompleteSuggestion = '',\n    id,\n    inputRef,\n    inputValue = '',\n    isMenuDirectlyActivated,\n    setInputValue,\n    setShowMenu,\n    showMenu\n  } = autocompleteContext;\n  useRefObjectAsForwardedRef(forwardedRef, inputRef);\n  const [highlightRemainingText, setHighlightRemainingText] = useState(true);\n  const {\n    safeSetTimeout\n  } = useSafeTimeout();\n  const handleInputFocus = useCallback(event => {\n    onFocus && onFocus(event);\n    setShowMenu(true);\n  }, [onFocus, setShowMenu]);\n  const handleInputBlur = useCallback(event => {\n    onBlur && onBlur(event);\n\n    // HACK: wait a tick and check the focused element before hiding the autocomplete menu\n    // this prevents the menu from hiding when the user is clicking an option in the Autoselect.Menu,\n    // but still hides the menu when the user blurs the input by tabbing out or clicking somewhere else on the page\n    safeSetTimeout(() => {\n      if (document.activeElement !== inputRef.current) {\n        setShowMenu(false);\n      }\n    }, 0);\n  }, [onBlur, setShowMenu, inputRef, safeSetTimeout]);\n  const handleInputChange = useCallback(event => {\n    onChange && onChange(event);\n    setInputValue(event.currentTarget.value);\n    if (!showMenu) {\n      setShowMenu(true);\n    }\n  }, [onChange, setInputValue, setShowMenu, showMenu]);\n  const handleInputKeyDown = useCallback(event => {\n    var _inputRef$current;\n    onKeyDown && onKeyDown(event);\n    if (event.key === 'Backspace') {\n      setHighlightRemainingText(false);\n    }\n    if (event.key === 'Escape' && (_inputRef$current = inputRef.current) !== null && _inputRef$current !== void 0 && _inputRef$current.value) {\n      setInputValue('');\n      inputRef.current.value = '';\n    }\n  }, [inputRef, setInputValue, setHighlightRemainingText, onKeyDown]);\n  const handleInputKeyUp = useCallback(event => {\n    onKeyUp && onKeyUp(event);\n    if (event.key === 'Backspace') {\n      setHighlightRemainingText(true);\n    }\n  }, [setHighlightRemainingText, onKeyUp]);\n  const onInputKeyPress = useCallback(event => {\n    onKeyPress && onKeyPress(event);\n    if (showMenu && event.key === 'Enter' && activeDescendantRef.current) {\n      event.preventDefault();\n      event.nativeEvent.stopImmediatePropagation();\n\n      // Forward Enter key press to active descendant so that item gets activated\n      const activeDescendantEvent = new KeyboardEvent(event.type, event.nativeEvent);\n      activeDescendantRef.current.dispatchEvent(activeDescendantEvent);\n    }\n  }, [activeDescendantRef, showMenu, onKeyPress]);\n  useEffect(() => {\n    if (!inputRef.current) {\n      return;\n    }\n\n    // resets input value to being empty after a selection has been made\n    if (!autocompleteSuggestion) {\n      inputRef.current.value = inputValue;\n    }\n\n    // TODO: fix bug where this function prevents `onChange` from being triggered if the highlighted item text\n    //       is the same as what I'm typing\n    //       e.g.: typing 'tw' highlights 'two', but when I 'two', the text input change does not get triggered\n    if (highlightRemainingText && autocompleteSuggestion && (inputValue || isMenuDirectlyActivated)) {\n      inputRef.current.value = autocompleteSuggestion;\n      if (autocompleteSuggestion.toLowerCase().indexOf(inputValue.toLowerCase()) === 0) {\n        inputRef.current.setSelectionRange(inputValue.length, autocompleteSuggestion.length);\n      }\n    }\n\n    // calling this useEffect when `highlightRemainingText` changes breaks backspace functionality\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [autocompleteSuggestion, inputValue, inputRef, isMenuDirectlyActivated]);\n  useEffect(() => {\n    setInputValue(typeof value !== 'undefined' ? value.toString() : '');\n  }, [value, setInputValue]);\n  return /*#__PURE__*/React.createElement(Component, _extends({\n    onFocus: handleInputFocus,\n    onBlur: handleInputBlur,\n    onChange: handleInputChange,\n    onKeyDown: handleInputKeyDown,\n    onKeyPress: onInputKeyPress,\n    onKeyUp: handleInputKeyUp,\n    ref: inputRef,\n    \"aria-controls\": `${id}-listbox`,\n    \"aria-autocomplete\": \"both\",\n    role: \"combobox\",\n    \"aria-expanded\": showMenu,\n    \"aria-haspopup\": \"listbox\",\n    \"aria-owns\": `${id}-listbox`,\n    autoComplete: \"off\",\n    id: id\n  }, props));\n});\nAutocompleteInput.displayName = 'AutocompleteInput';\nexport { AutocompleteInput as default };","map":{"version":3,"names":["React","useContext","useState","useCallback","useEffect","AutocompleteContext","TextInput","useRefObjectAsForwardedRef","useSafeTimeout","_extends","Object","assign","bind","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","AutocompleteInput","forwardRef","as","Component","onFocus","onBlur","onChange","onKeyDown","onKeyUp","onKeyPress","value","props","forwardedRef","autocompleteContext","Error","activeDescendantRef","autocompleteSuggestion","id","inputRef","inputValue","isMenuDirectlyActivated","setInputValue","setShowMenu","showMenu","highlightRemainingText","setHighlightRemainingText","safeSetTimeout","handleInputFocus","event","handleInputBlur","document","activeElement","current","handleInputChange","currentTarget","handleInputKeyDown","_inputRef$current","handleInputKeyUp","onInputKeyPress","preventDefault","nativeEvent","stopImmediatePropagation","activeDescendantEvent","KeyboardEvent","type","dispatchEvent","toLowerCase","indexOf","setSelectionRange","toString","createElement","ref","role","autoComplete","displayName","default"],"sources":["/Users/steve/Documents/repos/github/licensing-report/node_modules/@primer/react/lib-esm/Autocomplete/AutocompleteInput.js"],"sourcesContent":["import React, { useContext, useState, useCallback, useEffect } from 'react';\nimport { AutocompleteContext } from './AutocompleteContext.js';\nimport TextInput from '../TextInput/TextInput.js';\nimport { useRefObjectAsForwardedRef } from '../hooks/useRefObjectAsForwardedRef.js';\nimport useSafeTimeout from '../hooks/useSafeTimeout.js';\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nconst AutocompleteInput = /*#__PURE__*/React.forwardRef(({\n  as: Component = TextInput,\n  onFocus,\n  onBlur,\n  onChange,\n  onKeyDown,\n  onKeyUp,\n  onKeyPress,\n  value,\n  ...props\n}, forwardedRef) => {\n  const autocompleteContext = useContext(AutocompleteContext);\n  if (autocompleteContext === null) {\n    throw new Error('AutocompleteContext returned null values');\n  }\n  const {\n    activeDescendantRef,\n    autocompleteSuggestion = '',\n    id,\n    inputRef,\n    inputValue = '',\n    isMenuDirectlyActivated,\n    setInputValue,\n    setShowMenu,\n    showMenu\n  } = autocompleteContext;\n  useRefObjectAsForwardedRef(forwardedRef, inputRef);\n  const [highlightRemainingText, setHighlightRemainingText] = useState(true);\n  const {\n    safeSetTimeout\n  } = useSafeTimeout();\n  const handleInputFocus = useCallback(event => {\n    onFocus && onFocus(event);\n    setShowMenu(true);\n  }, [onFocus, setShowMenu]);\n  const handleInputBlur = useCallback(event => {\n    onBlur && onBlur(event);\n\n    // HACK: wait a tick and check the focused element before hiding the autocomplete menu\n    // this prevents the menu from hiding when the user is clicking an option in the Autoselect.Menu,\n    // but still hides the menu when the user blurs the input by tabbing out or clicking somewhere else on the page\n    safeSetTimeout(() => {\n      if (document.activeElement !== inputRef.current) {\n        setShowMenu(false);\n      }\n    }, 0);\n  }, [onBlur, setShowMenu, inputRef, safeSetTimeout]);\n  const handleInputChange = useCallback(event => {\n    onChange && onChange(event);\n    setInputValue(event.currentTarget.value);\n    if (!showMenu) {\n      setShowMenu(true);\n    }\n  }, [onChange, setInputValue, setShowMenu, showMenu]);\n  const handleInputKeyDown = useCallback(event => {\n    var _inputRef$current;\n    onKeyDown && onKeyDown(event);\n    if (event.key === 'Backspace') {\n      setHighlightRemainingText(false);\n    }\n    if (event.key === 'Escape' && (_inputRef$current = inputRef.current) !== null && _inputRef$current !== void 0 && _inputRef$current.value) {\n      setInputValue('');\n      inputRef.current.value = '';\n    }\n  }, [inputRef, setInputValue, setHighlightRemainingText, onKeyDown]);\n  const handleInputKeyUp = useCallback(event => {\n    onKeyUp && onKeyUp(event);\n    if (event.key === 'Backspace') {\n      setHighlightRemainingText(true);\n    }\n  }, [setHighlightRemainingText, onKeyUp]);\n  const onInputKeyPress = useCallback(event => {\n    onKeyPress && onKeyPress(event);\n    if (showMenu && event.key === 'Enter' && activeDescendantRef.current) {\n      event.preventDefault();\n      event.nativeEvent.stopImmediatePropagation();\n\n      // Forward Enter key press to active descendant so that item gets activated\n      const activeDescendantEvent = new KeyboardEvent(event.type, event.nativeEvent);\n      activeDescendantRef.current.dispatchEvent(activeDescendantEvent);\n    }\n  }, [activeDescendantRef, showMenu, onKeyPress]);\n  useEffect(() => {\n    if (!inputRef.current) {\n      return;\n    }\n\n    // resets input value to being empty after a selection has been made\n    if (!autocompleteSuggestion) {\n      inputRef.current.value = inputValue;\n    }\n\n    // TODO: fix bug where this function prevents `onChange` from being triggered if the highlighted item text\n    //       is the same as what I'm typing\n    //       e.g.: typing 'tw' highlights 'two', but when I 'two', the text input change does not get triggered\n    if (highlightRemainingText && autocompleteSuggestion && (inputValue || isMenuDirectlyActivated)) {\n      inputRef.current.value = autocompleteSuggestion;\n      if (autocompleteSuggestion.toLowerCase().indexOf(inputValue.toLowerCase()) === 0) {\n        inputRef.current.setSelectionRange(inputValue.length, autocompleteSuggestion.length);\n      }\n    }\n\n    // calling this useEffect when `highlightRemainingText` changes breaks backspace functionality\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [autocompleteSuggestion, inputValue, inputRef, isMenuDirectlyActivated]);\n  useEffect(() => {\n    setInputValue(typeof value !== 'undefined' ? value.toString() : '');\n  }, [value, setInputValue]);\n  return /*#__PURE__*/React.createElement(Component, _extends({\n    onFocus: handleInputFocus,\n    onBlur: handleInputBlur,\n    onChange: handleInputChange,\n    onKeyDown: handleInputKeyDown,\n    onKeyPress: onInputKeyPress,\n    onKeyUp: handleInputKeyUp,\n    ref: inputRef,\n    \"aria-controls\": `${id}-listbox`,\n    \"aria-autocomplete\": \"both\",\n    role: \"combobox\",\n    \"aria-expanded\": showMenu,\n    \"aria-haspopup\": \"listbox\",\n    \"aria-owns\": `${id}-listbox`,\n    autoComplete: \"off\",\n    id: id\n  }, props));\n});\nAutocompleteInput.displayName = 'AutocompleteInput';\n\nexport { AutocompleteInput as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}