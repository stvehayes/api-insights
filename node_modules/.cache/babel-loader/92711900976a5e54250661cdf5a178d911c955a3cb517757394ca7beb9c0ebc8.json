{"ast":null,"code":"import React, { forwardRef, useState, useRef, useEffect, useImperativeHandle, useCallback, useMemo } from 'react';\nimport Box from '../../Box/Box.js';\nimport VisuallyHidden from '../../_VisuallyHidden.js';\nimport { useId } from '../../hooks/useId.js';\nimport { useResizeObserver } from '../../hooks/useResizeObserver.js';\nimport { useSlots } from '../../hooks/useSlots.js';\nimport MarkdownViewer from '../MarkdownViewer/MarkdownViewer.js';\nimport { useIgnoreKeyboardActionsWhileComposing } from '../hooks/useIgnoreKeyboardActionsWhileComposing.js';\nimport { useSafeAsyncCallback } from '../hooks/useSafeAsyncCallback.js';\nimport { useSyntheticChange } from '../hooks/useSyntheticChange.js';\nimport { Actions } from './Actions.js';\nimport { Label } from './Label.js';\nimport { Toolbar, CoreToolbar, DefaultToolbarButtons } from './Toolbar.js';\nimport { Footer, CoreFooter } from './Footer.js';\nimport { FormattingTools } from './_FormattingTools.js';\nimport { MarkdownEditorContext } from './_MarkdownEditorContext.js';\nimport { MarkdownInput } from './_MarkdownInput.js';\nimport { SavedRepliesContext } from './_SavedReplies.js';\nimport { ViewSwitch } from './_ViewSwitch.js';\nimport { useFileHandling } from './_useFileHandling.js';\nimport { useIndenting } from './_useIndenting.js';\nimport { useListEditing } from './_useListEditing.js';\nimport { isModifierKey } from './utils.js';\nimport { ErrorMessage } from './_ErrorMessage.js';\nimport useIsomorphicLayoutEffect from '../../utils/useIsomorphicLayoutEffect.js';\nfunction _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nconst a11yOnlyStyle = {\n  clipPath: 'Circle(0)',\n  position: 'absolute'\n};\nconst CONDENSED_WIDTH_THRESHOLD = 675;\n\n/**\n * We want to switch editors from preview mode on cmd/ctrl+shift+P. But in preview mode,\n * there's no input to focus so we have to bind the event to the document. If there are\n * multiple editors, we want the most recent one to switch to preview mode to be the one\n * that we switch back to edit mode, so we maintain a LIFO stack of IDs of editors in\n * preview mode.\n */\nlet editorsInPreviewMode = [];\n\n/**\n * Markdown textarea with controls & keyboard shortcuts.\n * @deprecated Will be removed in v37 (https://github.com/primer/react/issues/3604)\n */\nconst MarkdownEditor = /*#__PURE__*/forwardRef(({\n  value,\n  onChange,\n  disabled = false,\n  placeholder,\n  maxLength,\n  'aria-describedby': describedBy,\n  fullHeight,\n  onRenderPreview,\n  sx,\n  onPrimaryAction,\n  viewMode: controlledViewMode,\n  onChangeViewMode: controlledSetViewMode,\n  minHeightLines = 5,\n  maxHeightLines = 35,\n  emojiSuggestions,\n  mentionSuggestions,\n  referenceSuggestions,\n  onUploadFile,\n  acceptedFileTypes,\n  monospace = false,\n  required = false,\n  name,\n  children,\n  savedReplies,\n  pasteUrlsAsPlainText = false\n}, ref) => {\n  var _slots$toolbar, _fileHandler$isDragge2, _slots$footer;\n  const [slots, childrenWithoutSlots] = useSlots(children, {\n    toolbar: Toolbar,\n    actions: Actions,\n    label: Label,\n    footer: Footer\n  });\n  const [uncontrolledViewMode, uncontrolledSetViewMode] = useState('edit');\n  const [view, setView] = controlledViewMode === undefined ? [uncontrolledViewMode, uncontrolledSetViewMode] : [controlledViewMode, controlledSetViewMode];\n  const [html, setHtml] = useState(null);\n  const safeSetHtml = useSafeAsyncCallback(setHtml);\n  const previewStale = useRef(true);\n  useEffect(() => {\n    previewStale.current = true;\n  }, [value]);\n  const loadPreview = async () => {\n    if (!previewStale.current) return;\n    previewStale.current = false; // set to false before the preview is rendered to prevent multiple concurrent calls\n    safeSetHtml(null);\n    safeSetHtml(await onRenderPreview(value));\n  };\n  useEffect(() => {\n    // we have to be careful here - loading preview sets state which causes a render which can cause an infinite loop,\n    // however that should be prevented by previewStale.current being set immediately in loadPreview\n    if (view === 'preview' && previewStale.current) loadPreview();\n  });\n  const inputRef = useRef(null);\n  useImperativeHandle(ref, () => ({\n    focus: opts => {\n      var _inputRef$current;\n      return (_inputRef$current = inputRef.current) === null || _inputRef$current === void 0 ? void 0 : _inputRef$current.focus(opts);\n    },\n    scrollIntoView: opts => {\n      var _containerRef$current;\n      return (_containerRef$current = containerRef.current) === null || _containerRef$current === void 0 ? void 0 : _containerRef$current.scrollIntoView(opts);\n    }\n  }));\n  const inputHeight = useRef(0);\n  if (inputRef.current && inputRef.current.offsetHeight) inputHeight.current = inputRef.current.offsetHeight;\n  const onInputChange = useCallback(e => {\n    onChange(e.target.value);\n  }, [onChange]);\n  const emitChange = useSyntheticChange({\n    inputRef,\n    fallbackEventHandler: onInputChange\n  });\n  const fileHandler = useFileHandling({\n    emitChange,\n    value,\n    inputRef,\n    disabled,\n    onUploadFile,\n    acceptedFileTypes\n  });\n  const listEditor = useListEditing({\n    emitChange\n  });\n  const indenter = useIndenting({\n    emitChange\n  });\n  const formattingToolsRef = useRef(null);\n\n  // use state instead of ref since we need to recalculate when the element mounts\n  const containerRef = useRef(null);\n  const [condensed, setCondensed] = useState(false);\n  const onResize = useCallback(\n  // it's fine that this isn't debounced because calling setCondensed with the current value will not trigger a render\n  () => setCondensed(containerRef.current !== null && containerRef.current.clientWidth < CONDENSED_WIDTH_THRESHOLD), []);\n  useResizeObserver(onResize, containerRef);\n\n  // workaround for Safari bug where layout is otherwise not recalculated\n  useIsomorphicLayoutEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n    const parent = container.parentElement;\n    const nextSibling = containerRef.current.nextSibling;\n    parent === null || parent === void 0 ? void 0 : parent.removeChild(container);\n    parent === null || parent === void 0 ? void 0 : parent.insertBefore(container, nextSibling);\n  }, [condensed]);\n\n  // the ID must be unique for each instance while remaining constant across renders\n  const id = useId();\n  const descriptionId = `${id}-description`;\n  const savedRepliesRef = useRef(null);\n  const onSelectSavedReply = reply => {\n    // need to wait a tick to run after the selectmenu finishes closing\n    requestAnimationFrame(() => emitChange(reply.content));\n  };\n  const savedRepliesContext = savedReplies ? {\n    savedReplies,\n    onSelect: onSelectSavedReply,\n    ref: savedRepliesRef\n  } : null;\n  const inputCompositionProps = useIgnoreKeyboardActionsWhileComposing(e => {\n    const format = formattingToolsRef.current;\n    if (disabled) return;\n    if (e.ctrlKey && e.key === '.') {\n      var _savedRepliesRef$curr;\n      // saved replies are always Control, even on Mac\n      (_savedRepliesRef$curr = savedRepliesRef.current) === null || _savedRepliesRef$curr === void 0 ? void 0 : _savedRepliesRef$curr.openMenu();\n      e.preventDefault();\n      e.stopPropagation();\n    } else if (isModifierKey(e)) {\n      if (e.key === 'Enter') onPrimaryAction === null || onPrimaryAction === void 0 ? void 0 : onPrimaryAction();else if (e.key === 'b') format === null || format === void 0 ? void 0 : format.bold();else if (e.key === 'i') format === null || format === void 0 ? void 0 : format.italic();else if (e.shiftKey && e.key === '.') format === null || format === void 0 ? void 0 : format.quote();else if (e.key === 'e') format === null || format === void 0 ? void 0 : format.code();else if (e.key === 'k') format === null || format === void 0 ? void 0 : format.link();else if (e.key === '8') format === null || format === void 0 ? void 0 : format.unorderedList();else if (e.shiftKey && e.key === '7') format === null || format === void 0 ? void 0 : format.orderedList();else if (e.shiftKey && e.key === 'l') format === null || format === void 0 ? void 0 : format.taskList();else if (e.shiftKey && e.key === 'p') setView === null || setView === void 0 ? void 0 : setView('preview');else return;\n      e.preventDefault();\n      e.stopPropagation();\n    } else {\n      listEditor.onKeyDown(e);\n      indenter.onKeyDown(e);\n    }\n  });\n  useEffect(() => {\n    if (view === 'preview') {\n      editorsInPreviewMode.push(id);\n      const handler = e => {\n        if (!e.defaultPrevented && editorsInPreviewMode.at(-1) === id && isModifierKey(e) && e.shiftKey && e.key === 'p') {\n          setView === null || setView === void 0 ? void 0 : setView('edit');\n          setTimeout(() => {\n            var _inputRef$current2;\n            return (_inputRef$current2 = inputRef.current) === null || _inputRef$current2 === void 0 ? void 0 : _inputRef$current2.focus();\n          });\n          e.preventDefault();\n        }\n      };\n      document.addEventListener('keydown', handler);\n      return () => {\n        document.removeEventListener('keydown', handler);\n        // Performing the filtering in the cleanup callback allows it to happen also when\n        // the user clicks the toggle button, not just on keyboard shortcut\n        editorsInPreviewMode = editorsInPreviewMode.filter(id_ => id_ !== id);\n      };\n    }\n  }, [view, setView, id]);\n\n  // If we don't memoize the context object, every child will rerender on every render even if memoized\n  const context = useMemo(() => {\n    var _fileHandler$isDragge, _fileHandler$clickTar;\n    return {\n      disabled,\n      formattingToolsRef,\n      condensed,\n      required,\n      fileDraggedOver: (_fileHandler$isDragge = fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.isDraggedOver) !== null && _fileHandler$isDragge !== void 0 ? _fileHandler$isDragge : false,\n      fileUploadProgress: fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.uploadProgress,\n      uploadButtonProps: (_fileHandler$clickTar = fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.clickTargetProps) !== null && _fileHandler$clickTar !== void 0 ? _fileHandler$clickTar : null,\n      errorMessage: fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.errorMessage,\n      previewMode: view === 'preview'\n    };\n  }, [disabled, condensed, required, fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.isDraggedOver, fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.uploadProgress, fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.clickTargetProps, fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.errorMessage, view]);\n\n  // We are using MarkdownEditorContext instead of the built-in Slots context because Slots' context is not typesafe\n  return /*#__PURE__*/React.createElement(MarkdownEditorContext.Provider, {\n    value: context\n  }, /*#__PURE__*/React.createElement(\"fieldset\", {\n    \"aria-disabled\": disabled /* if we set disabled={true}, we can't enable the buttons that should be enabled */,\n    \"aria-describedby\": describedBy ? `${descriptionId} ${describedBy}` : descriptionId,\n    style: {\n      appearance: 'none',\n      border: 'none',\n      minInlineSize: 'auto',\n      height: fullHeight ? '100%' : undefined\n    }\n  }, /*#__PURE__*/React.createElement(FormattingTools, {\n    ref: formattingToolsRef,\n    forInputId: id\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'none'\n    }\n  }, childrenWithoutSlots), slots.label, /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      display: 'flex',\n      flexDirection: 'column'\n    },\n    ref: containerRef\n  }, /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      display: 'flex',\n      flexDirection: 'column',\n      width: '100%',\n      borderColor: 'border.default',\n      borderWidth: 1,\n      borderStyle: 'solid',\n      borderRadius: 2,\n      height: fullHeight ? '100%' : undefined,\n      minInlineSize: 'auto',\n      bg: 'canvas.default',\n      color: disabled ? 'fg.subtle' : 'fg.default',\n      '&: focus-within': view === 'edit' ? {\n        outline: '2px solid',\n        outlineColor: 'accent.emphasis',\n        outlineOffset: '-1px'\n      } : {},\n      ...sx\n    }\n  }, /*#__PURE__*/React.createElement(VisuallyHidden, {\n    id: descriptionId,\n    \"aria-live\": \"polite\"\n  }, \"Markdown input:\", view === 'preview' ? ' preview mode selected.' : ' edit mode selected.'), /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      display: 'flex',\n      backgroundColor: 'canvas.subtle',\n      borderTopLeftRadius: 2,\n      borderTopRightRadius: 2,\n      justifyContent: 'space-between'\n    },\n    as: \"header\"\n  }, /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      ml: '-1px',\n      mt: '-1px',\n      display: 'flex',\n      alignItems: 'flex-end',\n      flexGrow: 1,\n      flexBasis: 0\n    }\n  }, /*#__PURE__*/React.createElement(ViewSwitch, {\n    selectedView: view,\n    onViewSelect: setView,\n    disabled: (fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.uploadProgress) !== undefined,\n    onLoadPreview: loadPreview\n  }), /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      borderBottom: '1px solid',\n      borderBottomColor: 'border.subtle',\n      flexGrow: 1\n    }\n  })), /*#__PURE__*/React.createElement(SavedRepliesContext.Provider, {\n    value: savedRepliesContext\n  }, view === 'edit' && ((_slots$toolbar = slots.toolbar) !== null && _slots$toolbar !== void 0 ? _slots$toolbar : /*#__PURE__*/React.createElement(CoreToolbar, null, /*#__PURE__*/React.createElement(DefaultToolbarButtons, null))))), /*#__PURE__*/React.createElement(MarkdownInput, _extends({\n    value: value,\n    onChange: onInputChange,\n    emojiSuggestions: emojiSuggestions,\n    mentionSuggestions: mentionSuggestions,\n    referenceSuggestions: referenceSuggestions,\n    disabled: disabled,\n    placeholder: placeholder,\n    id: id,\n    maxLength: maxLength,\n    ref: inputRef,\n    fullHeight: fullHeight,\n    isDraggedOver: (_fileHandler$isDragge2 = fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.isDraggedOver) !== null && _fileHandler$isDragge2 !== void 0 ? _fileHandler$isDragge2 : false,\n    minHeightLines: minHeightLines,\n    maxHeightLines: maxHeightLines,\n    visible: view === 'edit',\n    monospace: monospace,\n    required: required,\n    name: name,\n    pasteUrlsAsPlainText: pasteUrlsAsPlainText\n  }, inputCompositionProps, fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.pasteTargetProps, fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.dropTargetProps)), view === 'edit' && (fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.errorMessage) && /*#__PURE__*/React.createElement(ErrorMessage, {\n    message: fileHandler.errorMessage\n  }), view === 'preview' && /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      p: 3,\n      overflow: 'auto',\n      height: fullHeight ? '100%' : undefined,\n      minHeight: inputHeight.current,\n      boxSizing: 'border-box'\n    },\n    \"aria-live\": \"polite\",\n    tabIndex: -1\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    style: a11yOnlyStyle\n  }, \"Rendered Markdown Preview\"), /*#__PURE__*/React.createElement(MarkdownViewer, {\n    dangerousRenderedHTML: {\n      __html: html || 'Nothing to preview'\n    },\n    loading: html === null,\n    openLinksInNewTab: true\n  }))), (_slots$footer = slots.footer) !== null && _slots$footer !== void 0 ? _slots$footer : /*#__PURE__*/React.createElement(CoreFooter, null, /*#__PURE__*/React.isValidElement(slots.actions) && slots.actions.props.children))));\n});\nexport { MarkdownEditor as default };","map":{"version":3,"names":["React","forwardRef","useState","useRef","useEffect","useImperativeHandle","useCallback","useMemo","Box","VisuallyHidden","useId","useResizeObserver","useSlots","MarkdownViewer","useIgnoreKeyboardActionsWhileComposing","useSafeAsyncCallback","useSyntheticChange","Actions","Label","Toolbar","CoreToolbar","DefaultToolbarButtons","Footer","CoreFooter","FormattingTools","MarkdownEditorContext","MarkdownInput","SavedRepliesContext","ViewSwitch","useFileHandling","useIndenting","useListEditing","isModifierKey","ErrorMessage","useIsomorphicLayoutEffect","_extends","Object","assign","bind","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","a11yOnlyStyle","clipPath","position","CONDENSED_WIDTH_THRESHOLD","editorsInPreviewMode","MarkdownEditor","value","onChange","disabled","placeholder","maxLength","describedBy","fullHeight","onRenderPreview","sx","onPrimaryAction","viewMode","controlledViewMode","onChangeViewMode","controlledSetViewMode","minHeightLines","maxHeightLines","emojiSuggestions","mentionSuggestions","referenceSuggestions","onUploadFile","acceptedFileTypes","monospace","required","name","children","savedReplies","pasteUrlsAsPlainText","ref","_slots$toolbar","_fileHandler$isDragge2","_slots$footer","slots","childrenWithoutSlots","toolbar","actions","label","footer","uncontrolledViewMode","uncontrolledSetViewMode","view","setView","undefined","html","setHtml","safeSetHtml","previewStale","current","loadPreview","inputRef","focus","opts","_inputRef$current","scrollIntoView","_containerRef$current","containerRef","inputHeight","offsetHeight","onInputChange","e","emitChange","fallbackEventHandler","fileHandler","listEditor","indenter","formattingToolsRef","condensed","setCondensed","onResize","clientWidth","container","parent","parentElement","nextSibling","removeChild","insertBefore","id","descriptionId","savedRepliesRef","onSelectSavedReply","reply","requestAnimationFrame","content","savedRepliesContext","onSelect","inputCompositionProps","format","ctrlKey","_savedRepliesRef$curr","openMenu","preventDefault","stopPropagation","bold","italic","shiftKey","quote","code","link","unorderedList","orderedList","taskList","onKeyDown","push","handler","defaultPrevented","at","setTimeout","_inputRef$current2","document","addEventListener","removeEventListener","filter","id_","context","_fileHandler$isDragge","_fileHandler$clickTar","fileDraggedOver","isDraggedOver","fileUploadProgress","uploadProgress","uploadButtonProps","clickTargetProps","errorMessage","previewMode","createElement","Provider","style","appearance","border","minInlineSize","height","forInputId","display","flexDirection","width","borderColor","borderWidth","borderStyle","borderRadius","bg","color","outline","outlineColor","outlineOffset","backgroundColor","borderTopLeftRadius","borderTopRightRadius","justifyContent","as","ml","mt","alignItems","flexGrow","flexBasis","selectedView","onViewSelect","onLoadPreview","borderBottom","borderBottomColor","visible","pasteTargetProps","dropTargetProps","message","p","overflow","minHeight","boxSizing","tabIndex","dangerousRenderedHTML","__html","loading","openLinksInNewTab","isValidElement","props","default"],"sources":["/Users/steve/Documents/repos/github/api-insights/node_modules/@primer/react/lib-esm/drafts/MarkdownEditor/MarkdownEditor.js"],"sourcesContent":["import React, { forwardRef, useState, useRef, useEffect, useImperativeHandle, useCallback, useMemo } from 'react';\nimport Box from '../../Box/Box.js';\nimport VisuallyHidden from '../../_VisuallyHidden.js';\nimport { useId } from '../../hooks/useId.js';\nimport { useResizeObserver } from '../../hooks/useResizeObserver.js';\nimport { useSlots } from '../../hooks/useSlots.js';\nimport MarkdownViewer from '../MarkdownViewer/MarkdownViewer.js';\nimport { useIgnoreKeyboardActionsWhileComposing } from '../hooks/useIgnoreKeyboardActionsWhileComposing.js';\nimport { useSafeAsyncCallback } from '../hooks/useSafeAsyncCallback.js';\nimport { useSyntheticChange } from '../hooks/useSyntheticChange.js';\nimport { Actions } from './Actions.js';\nimport { Label } from './Label.js';\nimport { Toolbar, CoreToolbar, DefaultToolbarButtons } from './Toolbar.js';\nimport { Footer, CoreFooter } from './Footer.js';\nimport { FormattingTools } from './_FormattingTools.js';\nimport { MarkdownEditorContext } from './_MarkdownEditorContext.js';\nimport { MarkdownInput } from './_MarkdownInput.js';\nimport { SavedRepliesContext } from './_SavedReplies.js';\nimport { ViewSwitch } from './_ViewSwitch.js';\nimport { useFileHandling } from './_useFileHandling.js';\nimport { useIndenting } from './_useIndenting.js';\nimport { useListEditing } from './_useListEditing.js';\nimport { isModifierKey } from './utils.js';\nimport { ErrorMessage } from './_ErrorMessage.js';\nimport useIsomorphicLayoutEffect from '../../utils/useIsomorphicLayoutEffect.js';\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nconst a11yOnlyStyle = {\n  clipPath: 'Circle(0)',\n  position: 'absolute'\n};\nconst CONDENSED_WIDTH_THRESHOLD = 675;\n\n/**\n * We want to switch editors from preview mode on cmd/ctrl+shift+P. But in preview mode,\n * there's no input to focus so we have to bind the event to the document. If there are\n * multiple editors, we want the most recent one to switch to preview mode to be the one\n * that we switch back to edit mode, so we maintain a LIFO stack of IDs of editors in\n * preview mode.\n */\nlet editorsInPreviewMode = [];\n\n/**\n * Markdown textarea with controls & keyboard shortcuts.\n * @deprecated Will be removed in v37 (https://github.com/primer/react/issues/3604)\n */\nconst MarkdownEditor = /*#__PURE__*/forwardRef(({\n  value,\n  onChange,\n  disabled = false,\n  placeholder,\n  maxLength,\n  'aria-describedby': describedBy,\n  fullHeight,\n  onRenderPreview,\n  sx,\n  onPrimaryAction,\n  viewMode: controlledViewMode,\n  onChangeViewMode: controlledSetViewMode,\n  minHeightLines = 5,\n  maxHeightLines = 35,\n  emojiSuggestions,\n  mentionSuggestions,\n  referenceSuggestions,\n  onUploadFile,\n  acceptedFileTypes,\n  monospace = false,\n  required = false,\n  name,\n  children,\n  savedReplies,\n  pasteUrlsAsPlainText = false\n}, ref) => {\n  var _slots$toolbar, _fileHandler$isDragge2, _slots$footer;\n  const [slots, childrenWithoutSlots] = useSlots(children, {\n    toolbar: Toolbar,\n    actions: Actions,\n    label: Label,\n    footer: Footer\n  });\n  const [uncontrolledViewMode, uncontrolledSetViewMode] = useState('edit');\n  const [view, setView] = controlledViewMode === undefined ? [uncontrolledViewMode, uncontrolledSetViewMode] : [controlledViewMode, controlledSetViewMode];\n  const [html, setHtml] = useState(null);\n  const safeSetHtml = useSafeAsyncCallback(setHtml);\n  const previewStale = useRef(true);\n  useEffect(() => {\n    previewStale.current = true;\n  }, [value]);\n  const loadPreview = async () => {\n    if (!previewStale.current) return;\n    previewStale.current = false; // set to false before the preview is rendered to prevent multiple concurrent calls\n    safeSetHtml(null);\n    safeSetHtml(await onRenderPreview(value));\n  };\n  useEffect(() => {\n    // we have to be careful here - loading preview sets state which causes a render which can cause an infinite loop,\n    // however that should be prevented by previewStale.current being set immediately in loadPreview\n    if (view === 'preview' && previewStale.current) loadPreview();\n  });\n  const inputRef = useRef(null);\n  useImperativeHandle(ref, () => ({\n    focus: opts => {\n      var _inputRef$current;\n      return (_inputRef$current = inputRef.current) === null || _inputRef$current === void 0 ? void 0 : _inputRef$current.focus(opts);\n    },\n    scrollIntoView: opts => {\n      var _containerRef$current;\n      return (_containerRef$current = containerRef.current) === null || _containerRef$current === void 0 ? void 0 : _containerRef$current.scrollIntoView(opts);\n    }\n  }));\n  const inputHeight = useRef(0);\n  if (inputRef.current && inputRef.current.offsetHeight) inputHeight.current = inputRef.current.offsetHeight;\n  const onInputChange = useCallback(e => {\n    onChange(e.target.value);\n  }, [onChange]);\n  const emitChange = useSyntheticChange({\n    inputRef,\n    fallbackEventHandler: onInputChange\n  });\n  const fileHandler = useFileHandling({\n    emitChange,\n    value,\n    inputRef,\n    disabled,\n    onUploadFile,\n    acceptedFileTypes\n  });\n  const listEditor = useListEditing({\n    emitChange\n  });\n  const indenter = useIndenting({\n    emitChange\n  });\n  const formattingToolsRef = useRef(null);\n\n  // use state instead of ref since we need to recalculate when the element mounts\n  const containerRef = useRef(null);\n  const [condensed, setCondensed] = useState(false);\n  const onResize = useCallback(\n  // it's fine that this isn't debounced because calling setCondensed with the current value will not trigger a render\n  () => setCondensed(containerRef.current !== null && containerRef.current.clientWidth < CONDENSED_WIDTH_THRESHOLD), []);\n  useResizeObserver(onResize, containerRef);\n\n  // workaround for Safari bug where layout is otherwise not recalculated\n  useIsomorphicLayoutEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n    const parent = container.parentElement;\n    const nextSibling = containerRef.current.nextSibling;\n    parent === null || parent === void 0 ? void 0 : parent.removeChild(container);\n    parent === null || parent === void 0 ? void 0 : parent.insertBefore(container, nextSibling);\n  }, [condensed]);\n\n  // the ID must be unique for each instance while remaining constant across renders\n  const id = useId();\n  const descriptionId = `${id}-description`;\n  const savedRepliesRef = useRef(null);\n  const onSelectSavedReply = reply => {\n    // need to wait a tick to run after the selectmenu finishes closing\n    requestAnimationFrame(() => emitChange(reply.content));\n  };\n  const savedRepliesContext = savedReplies ? {\n    savedReplies,\n    onSelect: onSelectSavedReply,\n    ref: savedRepliesRef\n  } : null;\n  const inputCompositionProps = useIgnoreKeyboardActionsWhileComposing(e => {\n    const format = formattingToolsRef.current;\n    if (disabled) return;\n    if (e.ctrlKey && e.key === '.') {\n      var _savedRepliesRef$curr;\n      // saved replies are always Control, even on Mac\n      (_savedRepliesRef$curr = savedRepliesRef.current) === null || _savedRepliesRef$curr === void 0 ? void 0 : _savedRepliesRef$curr.openMenu();\n      e.preventDefault();\n      e.stopPropagation();\n    } else if (isModifierKey(e)) {\n      if (e.key === 'Enter') onPrimaryAction === null || onPrimaryAction === void 0 ? void 0 : onPrimaryAction();else if (e.key === 'b') format === null || format === void 0 ? void 0 : format.bold();else if (e.key === 'i') format === null || format === void 0 ? void 0 : format.italic();else if (e.shiftKey && e.key === '.') format === null || format === void 0 ? void 0 : format.quote();else if (e.key === 'e') format === null || format === void 0 ? void 0 : format.code();else if (e.key === 'k') format === null || format === void 0 ? void 0 : format.link();else if (e.key === '8') format === null || format === void 0 ? void 0 : format.unorderedList();else if (e.shiftKey && e.key === '7') format === null || format === void 0 ? void 0 : format.orderedList();else if (e.shiftKey && e.key === 'l') format === null || format === void 0 ? void 0 : format.taskList();else if (e.shiftKey && e.key === 'p') setView === null || setView === void 0 ? void 0 : setView('preview');else return;\n      e.preventDefault();\n      e.stopPropagation();\n    } else {\n      listEditor.onKeyDown(e);\n      indenter.onKeyDown(e);\n    }\n  });\n  useEffect(() => {\n    if (view === 'preview') {\n      editorsInPreviewMode.push(id);\n      const handler = e => {\n        if (!e.defaultPrevented && editorsInPreviewMode.at(-1) === id && isModifierKey(e) && e.shiftKey && e.key === 'p') {\n          setView === null || setView === void 0 ? void 0 : setView('edit');\n          setTimeout(() => {\n            var _inputRef$current2;\n            return (_inputRef$current2 = inputRef.current) === null || _inputRef$current2 === void 0 ? void 0 : _inputRef$current2.focus();\n          });\n          e.preventDefault();\n        }\n      };\n      document.addEventListener('keydown', handler);\n      return () => {\n        document.removeEventListener('keydown', handler);\n        // Performing the filtering in the cleanup callback allows it to happen also when\n        // the user clicks the toggle button, not just on keyboard shortcut\n        editorsInPreviewMode = editorsInPreviewMode.filter(id_ => id_ !== id);\n      };\n    }\n  }, [view, setView, id]);\n\n  // If we don't memoize the context object, every child will rerender on every render even if memoized\n  const context = useMemo(() => {\n    var _fileHandler$isDragge, _fileHandler$clickTar;\n    return {\n      disabled,\n      formattingToolsRef,\n      condensed,\n      required,\n      fileDraggedOver: (_fileHandler$isDragge = fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.isDraggedOver) !== null && _fileHandler$isDragge !== void 0 ? _fileHandler$isDragge : false,\n      fileUploadProgress: fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.uploadProgress,\n      uploadButtonProps: (_fileHandler$clickTar = fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.clickTargetProps) !== null && _fileHandler$clickTar !== void 0 ? _fileHandler$clickTar : null,\n      errorMessage: fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.errorMessage,\n      previewMode: view === 'preview'\n    };\n  }, [disabled, condensed, required, fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.isDraggedOver, fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.uploadProgress, fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.clickTargetProps, fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.errorMessage, view]);\n\n  // We are using MarkdownEditorContext instead of the built-in Slots context because Slots' context is not typesafe\n  return /*#__PURE__*/React.createElement(MarkdownEditorContext.Provider, {\n    value: context\n  }, /*#__PURE__*/React.createElement(\"fieldset\", {\n    \"aria-disabled\": disabled /* if we set disabled={true}, we can't enable the buttons that should be enabled */,\n    \"aria-describedby\": describedBy ? `${descriptionId} ${describedBy}` : descriptionId,\n    style: {\n      appearance: 'none',\n      border: 'none',\n      minInlineSize: 'auto',\n      height: fullHeight ? '100%' : undefined\n    }\n  }, /*#__PURE__*/React.createElement(FormattingTools, {\n    ref: formattingToolsRef,\n    forInputId: id\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'none'\n    }\n  }, childrenWithoutSlots), slots.label, /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      display: 'flex',\n      flexDirection: 'column'\n    },\n    ref: containerRef\n  }, /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      display: 'flex',\n      flexDirection: 'column',\n      width: '100%',\n      borderColor: 'border.default',\n      borderWidth: 1,\n      borderStyle: 'solid',\n      borderRadius: 2,\n      height: fullHeight ? '100%' : undefined,\n      minInlineSize: 'auto',\n      bg: 'canvas.default',\n      color: disabled ? 'fg.subtle' : 'fg.default',\n      '&: focus-within': view === 'edit' ? {\n        outline: '2px solid',\n        outlineColor: 'accent.emphasis',\n        outlineOffset: '-1px'\n      } : {},\n      ...sx\n    }\n  }, /*#__PURE__*/React.createElement(VisuallyHidden, {\n    id: descriptionId,\n    \"aria-live\": \"polite\"\n  }, \"Markdown input:\", view === 'preview' ? ' preview mode selected.' : ' edit mode selected.'), /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      display: 'flex',\n      backgroundColor: 'canvas.subtle',\n      borderTopLeftRadius: 2,\n      borderTopRightRadius: 2,\n      justifyContent: 'space-between'\n    },\n    as: \"header\"\n  }, /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      ml: '-1px',\n      mt: '-1px',\n      display: 'flex',\n      alignItems: 'flex-end',\n      flexGrow: 1,\n      flexBasis: 0\n    }\n  }, /*#__PURE__*/React.createElement(ViewSwitch, {\n    selectedView: view,\n    onViewSelect: setView,\n    disabled: (fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.uploadProgress) !== undefined,\n    onLoadPreview: loadPreview\n  }), /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      borderBottom: '1px solid',\n      borderBottomColor: 'border.subtle',\n      flexGrow: 1\n    }\n  })), /*#__PURE__*/React.createElement(SavedRepliesContext.Provider, {\n    value: savedRepliesContext\n  }, view === 'edit' && ((_slots$toolbar = slots.toolbar) !== null && _slots$toolbar !== void 0 ? _slots$toolbar : /*#__PURE__*/React.createElement(CoreToolbar, null, /*#__PURE__*/React.createElement(DefaultToolbarButtons, null))))), /*#__PURE__*/React.createElement(MarkdownInput, _extends({\n    value: value,\n    onChange: onInputChange,\n    emojiSuggestions: emojiSuggestions,\n    mentionSuggestions: mentionSuggestions,\n    referenceSuggestions: referenceSuggestions,\n    disabled: disabled,\n    placeholder: placeholder,\n    id: id,\n    maxLength: maxLength,\n    ref: inputRef,\n    fullHeight: fullHeight,\n    isDraggedOver: (_fileHandler$isDragge2 = fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.isDraggedOver) !== null && _fileHandler$isDragge2 !== void 0 ? _fileHandler$isDragge2 : false,\n    minHeightLines: minHeightLines,\n    maxHeightLines: maxHeightLines,\n    visible: view === 'edit',\n    monospace: monospace,\n    required: required,\n    name: name,\n    pasteUrlsAsPlainText: pasteUrlsAsPlainText\n  }, inputCompositionProps, fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.pasteTargetProps, fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.dropTargetProps)), view === 'edit' && (fileHandler === null || fileHandler === void 0 ? void 0 : fileHandler.errorMessage) && /*#__PURE__*/React.createElement(ErrorMessage, {\n    message: fileHandler.errorMessage\n  }), view === 'preview' && /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      p: 3,\n      overflow: 'auto',\n      height: fullHeight ? '100%' : undefined,\n      minHeight: inputHeight.current,\n      boxSizing: 'border-box'\n    },\n    \"aria-live\": \"polite\",\n    tabIndex: -1\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    style: a11yOnlyStyle\n  }, \"Rendered Markdown Preview\"), /*#__PURE__*/React.createElement(MarkdownViewer, {\n    dangerousRenderedHTML: {\n      __html: html || 'Nothing to preview'\n    },\n    loading: html === null,\n    openLinksInNewTab: true\n  }))), (_slots$footer = slots.footer) !== null && _slots$footer !== void 0 ? _slots$footer : /*#__PURE__*/React.createElement(CoreFooter, null, /*#__PURE__*/React.isValidElement(slots.actions) && slots.actions.props.children))));\n});\n\nexport { MarkdownEditor as default };\n"],"mappings":"AAAA,OAAOA,KAAK,IAAIC,UAAU,EAAEC,QAAQ,EAAEC,MAAM,EAAEC,SAAS,EAAEC,mBAAmB,EAAEC,WAAW,EAAEC,OAAO,QAAQ,OAAO;AACjH,OAAOC,GAAG,MAAM,kBAAkB;AAClC,OAAOC,cAAc,MAAM,0BAA0B;AACrD,SAASC,KAAK,QAAQ,sBAAsB;AAC5C,SAASC,iBAAiB,QAAQ,kCAAkC;AACpE,SAASC,QAAQ,QAAQ,yBAAyB;AAClD,OAAOC,cAAc,MAAM,qCAAqC;AAChE,SAASC,sCAAsC,QAAQ,oDAAoD;AAC3G,SAASC,oBAAoB,QAAQ,kCAAkC;AACvE,SAASC,kBAAkB,QAAQ,gCAAgC;AACnE,SAASC,OAAO,QAAQ,cAAc;AACtC,SAASC,KAAK,QAAQ,YAAY;AAClC,SAASC,OAAO,EAAEC,WAAW,EAAEC,qBAAqB,QAAQ,cAAc;AAC1E,SAASC,MAAM,EAAEC,UAAU,QAAQ,aAAa;AAChD,SAASC,eAAe,QAAQ,uBAAuB;AACvD,SAASC,qBAAqB,QAAQ,6BAA6B;AACnE,SAASC,aAAa,QAAQ,qBAAqB;AACnD,SAASC,mBAAmB,QAAQ,oBAAoB;AACxD,SAASC,UAAU,QAAQ,kBAAkB;AAC7C,SAASC,eAAe,QAAQ,uBAAuB;AACvD,SAASC,YAAY,QAAQ,oBAAoB;AACjD,SAASC,cAAc,QAAQ,sBAAsB;AACrD,SAASC,aAAa,QAAQ,YAAY;AAC1C,SAASC,YAAY,QAAQ,oBAAoB;AACjD,OAAOC,yBAAyB,MAAM,0CAA0C;AAEhF,SAASC,QAAQA,CAAA,EAAG;EAAEA,QAAQ,GAAGC,MAAM,CAACC,MAAM,GAAGD,MAAM,CAACC,MAAM,CAACC,IAAI,CAAC,CAAC,GAAG,UAAUC,MAAM,EAAE;IAAE,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGC,SAAS,CAACC,MAAM,EAAEF,CAAC,EAAE,EAAE;MAAE,IAAIG,MAAM,GAAGF,SAAS,CAACD,CAAC,CAAC;MAAE,KAAK,IAAII,GAAG,IAAID,MAAM,EAAE;QAAE,IAAIP,MAAM,CAACS,SAAS,CAACC,cAAc,CAACC,IAAI,CAACJ,MAAM,EAAEC,GAAG,CAAC,EAAE;UAAEL,MAAM,CAACK,GAAG,CAAC,GAAGD,MAAM,CAACC,GAAG,CAAC;QAAE;MAAE;IAAE;IAAE,OAAOL,MAAM;EAAE,CAAC;EAAE,OAAOJ,QAAQ,CAACa,KAAK,CAAC,IAAI,EAAEP,SAAS,CAAC;AAAE;AAClV,MAAMQ,aAAa,GAAG;EACpBC,QAAQ,EAAE,WAAW;EACrBC,QAAQ,EAAE;AACZ,CAAC;AACD,MAAMC,yBAAyB,GAAG,GAAG;;AAErC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAIC,oBAAoB,GAAG,EAAE;;AAE7B;AACA;AACA;AACA;AACA,MAAMC,cAAc,GAAG,aAAarD,UAAU,CAAC,CAAC;EAC9CsD,KAAK;EACLC,QAAQ;EACRC,QAAQ,GAAG,KAAK;EAChBC,WAAW;EACXC,SAAS;EACT,kBAAkB,EAAEC,WAAW;EAC/BC,UAAU;EACVC,eAAe;EACfC,EAAE;EACFC,eAAe;EACfC,QAAQ,EAAEC,kBAAkB;EAC5BC,gBAAgB,EAAEC,qBAAqB;EACvCC,cAAc,GAAG,CAAC;EAClBC,cAAc,GAAG,EAAE;EACnBC,gBAAgB;EAChBC,kBAAkB;EAClBC,oBAAoB;EACpBC,YAAY;EACZC,iBAAiB;EACjBC,SAAS,GAAG,KAAK;EACjBC,QAAQ,GAAG,KAAK;EAChBC,IAAI;EACJC,QAAQ;EACRC,YAAY;EACZC,oBAAoB,GAAG;AACzB,CAAC,EAAEC,GAAG,KAAK;EACT,IAAIC,cAAc,EAAEC,sBAAsB,EAAEC,aAAa;EACzD,MAAM,CAACC,KAAK,EAAEC,oBAAoB,CAAC,GAAG3E,QAAQ,CAACmE,QAAQ,EAAE;IACvDS,OAAO,EAAErE,OAAO;IAChBsE,OAAO,EAAExE,OAAO;IAChByE,KAAK,EAAExE,KAAK;IACZyE,MAAM,EAAErE;EACV,CAAC,CAAC;EACF,MAAM,CAACsE,oBAAoB,EAAEC,uBAAuB,CAAC,GAAG3F,QAAQ,CAAC,MAAM,CAAC;EACxE,MAAM,CAAC4F,IAAI,EAAEC,OAAO,CAAC,GAAG7B,kBAAkB,KAAK8B,SAAS,GAAG,CAACJ,oBAAoB,EAAEC,uBAAuB,CAAC,GAAG,CAAC3B,kBAAkB,EAAEE,qBAAqB,CAAC;EACxJ,MAAM,CAAC6B,IAAI,EAAEC,OAAO,CAAC,GAAGhG,QAAQ,CAAC,IAAI,CAAC;EACtC,MAAMiG,WAAW,GAAGpF,oBAAoB,CAACmF,OAAO,CAAC;EACjD,MAAME,YAAY,GAAGjG,MAAM,CAAC,IAAI,CAAC;EACjCC,SAAS,CAAC,MAAM;IACdgG,YAAY,CAACC,OAAO,GAAG,IAAI;EAC7B,CAAC,EAAE,CAAC9C,KAAK,CAAC,CAAC;EACX,MAAM+C,WAAW,GAAG,MAAAA,CAAA,KAAY;IAC9B,IAAI,CAACF,YAAY,CAACC,OAAO,EAAE;IAC3BD,YAAY,CAACC,OAAO,GAAG,KAAK,CAAC,CAAC;IAC9BF,WAAW,CAAC,IAAI,CAAC;IACjBA,WAAW,CAAC,MAAMrC,eAAe,CAACP,KAAK,CAAC,CAAC;EAC3C,CAAC;EACDnD,SAAS,CAAC,MAAM;IACd;IACA;IACA,IAAI0F,IAAI,KAAK,SAAS,IAAIM,YAAY,CAACC,OAAO,EAAEC,WAAW,CAAC,CAAC;EAC/D,CAAC,CAAC;EACF,MAAMC,QAAQ,GAAGpG,MAAM,CAAC,IAAI,CAAC;EAC7BE,mBAAmB,CAAC6E,GAAG,EAAE,OAAO;IAC9BsB,KAAK,EAAEC,IAAI,IAAI;MACb,IAAIC,iBAAiB;MACrB,OAAO,CAACA,iBAAiB,GAAGH,QAAQ,CAACF,OAAO,MAAM,IAAI,IAAIK,iBAAiB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,iBAAiB,CAACF,KAAK,CAACC,IAAI,CAAC;IACjI,CAAC;IACDE,cAAc,EAAEF,IAAI,IAAI;MACtB,IAAIG,qBAAqB;MACzB,OAAO,CAACA,qBAAqB,GAAGC,YAAY,CAACR,OAAO,MAAM,IAAI,IAAIO,qBAAqB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,qBAAqB,CAACD,cAAc,CAACF,IAAI,CAAC;IAC1J;EACF,CAAC,CAAC,CAAC;EACH,MAAMK,WAAW,GAAG3G,MAAM,CAAC,CAAC,CAAC;EAC7B,IAAIoG,QAAQ,CAACF,OAAO,IAAIE,QAAQ,CAACF,OAAO,CAACU,YAAY,EAAED,WAAW,CAACT,OAAO,GAAGE,QAAQ,CAACF,OAAO,CAACU,YAAY;EAC1G,MAAMC,aAAa,GAAG1G,WAAW,CAAC2G,CAAC,IAAI;IACrCzD,QAAQ,CAACyD,CAAC,CAAC1E,MAAM,CAACgB,KAAK,CAAC;EAC1B,CAAC,EAAE,CAACC,QAAQ,CAAC,CAAC;EACd,MAAM0D,UAAU,GAAGlG,kBAAkB,CAAC;IACpCuF,QAAQ;IACRY,oBAAoB,EAAEH;EACxB,CAAC,CAAC;EACF,MAAMI,WAAW,GAAGvF,eAAe,CAAC;IAClCqF,UAAU;IACV3D,KAAK;IACLgD,QAAQ;IACR9C,QAAQ;IACRiB,YAAY;IACZC;EACF,CAAC,CAAC;EACF,MAAM0C,UAAU,GAAGtF,cAAc,CAAC;IAChCmF;EACF,CAAC,CAAC;EACF,MAAMI,QAAQ,GAAGxF,YAAY,CAAC;IAC5BoF;EACF,CAAC,CAAC;EACF,MAAMK,kBAAkB,GAAGpH,MAAM,CAAC,IAAI,CAAC;;EAEvC;EACA,MAAM0G,YAAY,GAAG1G,MAAM,CAAC,IAAI,CAAC;EACjC,MAAM,CAACqH,SAAS,EAAEC,YAAY,CAAC,GAAGvH,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAMwH,QAAQ,GAAGpH,WAAW;EAC5B;EACA,MAAMmH,YAAY,CAACZ,YAAY,CAACR,OAAO,KAAK,IAAI,IAAIQ,YAAY,CAACR,OAAO,CAACsB,WAAW,GAAGvE,yBAAyB,CAAC,EAAE,EAAE,CAAC;EACtHzC,iBAAiB,CAAC+G,QAAQ,EAAEb,YAAY,CAAC;;EAEzC;EACA3E,yBAAyB,CAAC,MAAM;IAC9B,MAAM0F,SAAS,GAAGf,YAAY,CAACR,OAAO;IACtC,IAAI,CAACuB,SAAS,EAAE;IAChB,MAAMC,MAAM,GAAGD,SAAS,CAACE,aAAa;IACtC,MAAMC,WAAW,GAAGlB,YAAY,CAACR,OAAO,CAAC0B,WAAW;IACpDF,MAAM,KAAK,IAAI,IAAIA,MAAM,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,MAAM,CAACG,WAAW,CAACJ,SAAS,CAAC;IAC7EC,MAAM,KAAK,IAAI,IAAIA,MAAM,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,MAAM,CAACI,YAAY,CAACL,SAAS,EAAEG,WAAW,CAAC;EAC7F,CAAC,EAAE,CAACP,SAAS,CAAC,CAAC;;EAEf;EACA,MAAMU,EAAE,GAAGxH,KAAK,CAAC,CAAC;EAClB,MAAMyH,aAAa,GAAI,GAAED,EAAG,cAAa;EACzC,MAAME,eAAe,GAAGjI,MAAM,CAAC,IAAI,CAAC;EACpC,MAAMkI,kBAAkB,GAAGC,KAAK,IAAI;IAClC;IACAC,qBAAqB,CAAC,MAAMrB,UAAU,CAACoB,KAAK,CAACE,OAAO,CAAC,CAAC;EACxD,CAAC;EACD,MAAMC,mBAAmB,GAAGzD,YAAY,GAAG;IACzCA,YAAY;IACZ0D,QAAQ,EAAEL,kBAAkB;IAC5BnD,GAAG,EAAEkD;EACP,CAAC,GAAG,IAAI;EACR,MAAMO,qBAAqB,GAAG7H,sCAAsC,CAACmG,CAAC,IAAI;IACxE,MAAM2B,MAAM,GAAGrB,kBAAkB,CAAClB,OAAO;IACzC,IAAI5C,QAAQ,EAAE;IACd,IAAIwD,CAAC,CAAC4B,OAAO,IAAI5B,CAAC,CAACrE,GAAG,KAAK,GAAG,EAAE;MAC9B,IAAIkG,qBAAqB;MACzB;MACA,CAACA,qBAAqB,GAAGV,eAAe,CAAC/B,OAAO,MAAM,IAAI,IAAIyC,qBAAqB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,qBAAqB,CAACC,QAAQ,CAAC,CAAC;MAC1I9B,CAAC,CAAC+B,cAAc,CAAC,CAAC;MAClB/B,CAAC,CAACgC,eAAe,CAAC,CAAC;IACrB,CAAC,MAAM,IAAIjH,aAAa,CAACiF,CAAC,CAAC,EAAE;MAC3B,IAAIA,CAAC,CAACrE,GAAG,KAAK,OAAO,EAAEoB,eAAe,KAAK,IAAI,IAAIA,eAAe,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,eAAe,CAAC,CAAC,CAAC,KAAK,IAAIiD,CAAC,CAACrE,GAAG,KAAK,GAAG,EAAEgG,MAAM,KAAK,IAAI,IAAIA,MAAM,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,MAAM,CAACM,IAAI,CAAC,CAAC,CAAC,KAAK,IAAIjC,CAAC,CAACrE,GAAG,KAAK,GAAG,EAAEgG,MAAM,KAAK,IAAI,IAAIA,MAAM,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,MAAM,CAACO,MAAM,CAAC,CAAC,CAAC,KAAK,IAAIlC,CAAC,CAACmC,QAAQ,IAAInC,CAAC,CAACrE,GAAG,KAAK,GAAG,EAAEgG,MAAM,KAAK,IAAI,IAAIA,MAAM,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,MAAM,CAACS,KAAK,CAAC,CAAC,CAAC,KAAK,IAAIpC,CAAC,CAACrE,GAAG,KAAK,GAAG,EAAEgG,MAAM,KAAK,IAAI,IAAIA,MAAM,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,MAAM,CAACU,IAAI,CAAC,CAAC,CAAC,KAAK,IAAIrC,CAAC,CAACrE,GAAG,KAAK,GAAG,EAAEgG,MAAM,KAAK,IAAI,IAAIA,MAAM,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,MAAM,CAACW,IAAI,CAAC,CAAC,CAAC,KAAK,IAAItC,CAAC,CAACrE,GAAG,KAAK,GAAG,EAAEgG,MAAM,KAAK,IAAI,IAAIA,MAAM,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,MAAM,CAACY,aAAa,CAAC,CAAC,CAAC,KAAK,IAAIvC,CAAC,CAACmC,QAAQ,IAAInC,CAAC,CAACrE,GAAG,KAAK,GAAG,EAAEgG,MAAM,KAAK,IAAI,IAAIA,MAAM,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,MAAM,CAACa,WAAW,CAAC,CAAC,CAAC,KAAK,IAAIxC,CAAC,CAACmC,QAAQ,IAAInC,CAAC,CAACrE,GAAG,KAAK,GAAG,EAAEgG,MAAM,KAAK,IAAI,IAAIA,MAAM,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,MAAM,CAACc,QAAQ,CAAC,CAAC,CAAC,KAAK,IAAIzC,CAAC,CAACmC,QAAQ,IAAInC,CAAC,CAACrE,GAAG,KAAK,GAAG,EAAEmD,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,OAAO,CAAC,SAAS,CAAC,CAAC,KAAK;MAC58BkB,CAAC,CAAC+B,cAAc,CAAC,CAAC;MAClB/B,CAAC,CAACgC,eAAe,CAAC,CAAC;IACrB,CAAC,MAAM;MACL5B,UAAU,CAACsC,SAAS,CAAC1C,CAAC,CAAC;MACvBK,QAAQ,CAACqC,SAAS,CAAC1C,CAAC,CAAC;IACvB;EACF,CAAC,CAAC;EACF7G,SAAS,CAAC,MAAM;IACd,IAAI0F,IAAI,KAAK,SAAS,EAAE;MACtBzC,oBAAoB,CAACuG,IAAI,CAAC1B,EAAE,CAAC;MAC7B,MAAM2B,OAAO,GAAG5C,CAAC,IAAI;QACnB,IAAI,CAACA,CAAC,CAAC6C,gBAAgB,IAAIzG,oBAAoB,CAAC0G,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK7B,EAAE,IAAIlG,aAAa,CAACiF,CAAC,CAAC,IAAIA,CAAC,CAACmC,QAAQ,IAAInC,CAAC,CAACrE,GAAG,KAAK,GAAG,EAAE;UAChHmD,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,OAAO,CAAC,MAAM,CAAC;UACjEiE,UAAU,CAAC,MAAM;YACf,IAAIC,kBAAkB;YACtB,OAAO,CAACA,kBAAkB,GAAG1D,QAAQ,CAACF,OAAO,MAAM,IAAI,IAAI4D,kBAAkB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,kBAAkB,CAACzD,KAAK,CAAC,CAAC;UAChI,CAAC,CAAC;UACFS,CAAC,CAAC+B,cAAc,CAAC,CAAC;QACpB;MACF,CAAC;MACDkB,QAAQ,CAACC,gBAAgB,CAAC,SAAS,EAAEN,OAAO,CAAC;MAC7C,OAAO,MAAM;QACXK,QAAQ,CAACE,mBAAmB,CAAC,SAAS,EAAEP,OAAO,CAAC;QAChD;QACA;QACAxG,oBAAoB,GAAGA,oBAAoB,CAACgH,MAAM,CAACC,GAAG,IAAIA,GAAG,KAAKpC,EAAE,CAAC;MACvE,CAAC;IACH;EACF,CAAC,EAAE,CAACpC,IAAI,EAAEC,OAAO,EAAEmC,EAAE,CAAC,CAAC;;EAEvB;EACA,MAAMqC,OAAO,GAAGhK,OAAO,CAAC,MAAM;IAC5B,IAAIiK,qBAAqB,EAAEC,qBAAqB;IAChD,OAAO;MACLhH,QAAQ;MACR8D,kBAAkB;MAClBC,SAAS;MACT3C,QAAQ;MACR6F,eAAe,EAAE,CAACF,qBAAqB,GAAGpD,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,WAAW,CAACuD,aAAa,MAAM,IAAI,IAAIH,qBAAqB,KAAK,KAAK,CAAC,GAAGA,qBAAqB,GAAG,KAAK;MAC3MI,kBAAkB,EAAExD,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,WAAW,CAACyD,cAAc;MACxGC,iBAAiB,EAAE,CAACL,qBAAqB,GAAGrD,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,WAAW,CAAC2D,gBAAgB,MAAM,IAAI,IAAIN,qBAAqB,KAAK,KAAK,CAAC,GAAGA,qBAAqB,GAAG,IAAI;MAC/MO,YAAY,EAAE5D,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,WAAW,CAAC4D,YAAY;MAChGC,WAAW,EAAEnF,IAAI,KAAK;IACxB,CAAC;EACH,CAAC,EAAE,CAACrC,QAAQ,EAAE+D,SAAS,EAAE3C,QAAQ,EAAEuC,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,WAAW,CAACuD,aAAa,EAAEvD,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,WAAW,CAACyD,cAAc,EAAEzD,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,WAAW,CAAC2D,gBAAgB,EAAE3D,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,WAAW,CAAC4D,YAAY,EAAElF,IAAI,CAAC,CAAC;;EAEhY;EACA,OAAO,aAAa9F,KAAK,CAACkL,aAAa,CAACzJ,qBAAqB,CAAC0J,QAAQ,EAAE;IACtE5H,KAAK,EAAEgH;EACT,CAAC,EAAE,aAAavK,KAAK,CAACkL,aAAa,CAAC,UAAU,EAAE;IAC9C,eAAe,EAAEzH,QAAQ,CAAC;IAC1B,kBAAkB,EAAEG,WAAW,GAAI,GAAEuE,aAAc,IAAGvE,WAAY,EAAC,GAAGuE,aAAa;IACnFiD,KAAK,EAAE;MACLC,UAAU,EAAE,MAAM;MAClBC,MAAM,EAAE,MAAM;MACdC,aAAa,EAAE,MAAM;MACrBC,MAAM,EAAE3H,UAAU,GAAG,MAAM,GAAGmC;IAChC;EACF,CAAC,EAAE,aAAahG,KAAK,CAACkL,aAAa,CAAC1J,eAAe,EAAE;IACnD0D,GAAG,EAAEqC,kBAAkB;IACvBkE,UAAU,EAAEvD;EACd,CAAC,CAAC,EAAE,aAAalI,KAAK,CAACkL,aAAa,CAAC,KAAK,EAAE;IAC1CE,KAAK,EAAE;MACLM,OAAO,EAAE;IACX;EACF,CAAC,EAAEnG,oBAAoB,CAAC,EAAED,KAAK,CAACI,KAAK,EAAE,aAAa1F,KAAK,CAACkL,aAAa,CAAC1K,GAAG,EAAE;IAC3EuD,EAAE,EAAE;MACF2H,OAAO,EAAE,MAAM;MACfC,aAAa,EAAE;IACjB,CAAC;IACDzG,GAAG,EAAE2B;EACP,CAAC,EAAE,aAAa7G,KAAK,CAACkL,aAAa,CAAC1K,GAAG,EAAE;IACvCuD,EAAE,EAAE;MACF2H,OAAO,EAAE,MAAM;MACfC,aAAa,EAAE,QAAQ;MACvBC,KAAK,EAAE,MAAM;MACbC,WAAW,EAAE,gBAAgB;MAC7BC,WAAW,EAAE,CAAC;MACdC,WAAW,EAAE,OAAO;MACpBC,YAAY,EAAE,CAAC;MACfR,MAAM,EAAE3H,UAAU,GAAG,MAAM,GAAGmC,SAAS;MACvCuF,aAAa,EAAE,MAAM;MACrBU,EAAE,EAAE,gBAAgB;MACpBC,KAAK,EAAEzI,QAAQ,GAAG,WAAW,GAAG,YAAY;MAC5C,iBAAiB,EAAEqC,IAAI,KAAK,MAAM,GAAG;QACnCqG,OAAO,EAAE,WAAW;QACpBC,YAAY,EAAE,iBAAiB;QAC/BC,aAAa,EAAE;MACjB,CAAC,GAAG,CAAC,CAAC;MACN,GAAGtI;IACL;EACF,CAAC,EAAE,aAAa/D,KAAK,CAACkL,aAAa,CAACzK,cAAc,EAAE;IAClDyH,EAAE,EAAEC,aAAa;IACjB,WAAW,EAAE;EACf,CAAC,EAAE,iBAAiB,EAAErC,IAAI,KAAK,SAAS,GAAG,yBAAyB,GAAG,sBAAsB,CAAC,EAAE,aAAa9F,KAAK,CAACkL,aAAa,CAAC1K,GAAG,EAAE;IACpIuD,EAAE,EAAE;MACF2H,OAAO,EAAE,MAAM;MACfY,eAAe,EAAE,eAAe;MAChCC,mBAAmB,EAAE,CAAC;MACtBC,oBAAoB,EAAE,CAAC;MACvBC,cAAc,EAAE;IAClB,CAAC;IACDC,EAAE,EAAE;EACN,CAAC,EAAE,aAAa1M,KAAK,CAACkL,aAAa,CAAC1K,GAAG,EAAE;IACvCuD,EAAE,EAAE;MACF4I,EAAE,EAAE,MAAM;MACVC,EAAE,EAAE,MAAM;MACVlB,OAAO,EAAE,MAAM;MACfmB,UAAU,EAAE,UAAU;MACtBC,QAAQ,EAAE,CAAC;MACXC,SAAS,EAAE;IACb;EACF,CAAC,EAAE,aAAa/M,KAAK,CAACkL,aAAa,CAACtJ,UAAU,EAAE;IAC9CoL,YAAY,EAAElH,IAAI;IAClBmH,YAAY,EAAElH,OAAO;IACrBtC,QAAQ,EAAE,CAAC2D,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,WAAW,CAACyD,cAAc,MAAM7E,SAAS;IAC9GkH,aAAa,EAAE5G;EACjB,CAAC,CAAC,EAAE,aAAatG,KAAK,CAACkL,aAAa,CAAC1K,GAAG,EAAE;IACxCuD,EAAE,EAAE;MACFoJ,YAAY,EAAE,WAAW;MACzBC,iBAAiB,EAAE,eAAe;MAClCN,QAAQ,EAAE;IACZ;EACF,CAAC,CAAC,CAAC,EAAE,aAAa9M,KAAK,CAACkL,aAAa,CAACvJ,mBAAmB,CAACwJ,QAAQ,EAAE;IAClE5H,KAAK,EAAEkF;EACT,CAAC,EAAE3C,IAAI,KAAK,MAAM,KAAK,CAACX,cAAc,GAAGG,KAAK,CAACE,OAAO,MAAM,IAAI,IAAIL,cAAc,KAAK,KAAK,CAAC,GAAGA,cAAc,GAAG,aAAanF,KAAK,CAACkL,aAAa,CAAC9J,WAAW,EAAE,IAAI,EAAE,aAAapB,KAAK,CAACkL,aAAa,CAAC7J,qBAAqB,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,aAAarB,KAAK,CAACkL,aAAa,CAACxJ,aAAa,EAAES,QAAQ,CAAC;IAC/RoB,KAAK,EAAEA,KAAK;IACZC,QAAQ,EAAEwD,aAAa;IACvBzC,gBAAgB,EAAEA,gBAAgB;IAClCC,kBAAkB,EAAEA,kBAAkB;IACtCC,oBAAoB,EAAEA,oBAAoB;IAC1ChB,QAAQ,EAAEA,QAAQ;IAClBC,WAAW,EAAEA,WAAW;IACxBwE,EAAE,EAAEA,EAAE;IACNvE,SAAS,EAAEA,SAAS;IACpBuB,GAAG,EAAEqB,QAAQ;IACb1C,UAAU,EAAEA,UAAU;IACtB8G,aAAa,EAAE,CAACvF,sBAAsB,GAAGgC,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,WAAW,CAACuD,aAAa,MAAM,IAAI,IAAIvF,sBAAsB,KAAK,KAAK,CAAC,GAAGA,sBAAsB,GAAG,KAAK;IAC5Mf,cAAc,EAAEA,cAAc;IAC9BC,cAAc,EAAEA,cAAc;IAC9B+I,OAAO,EAAEvH,IAAI,KAAK,MAAM;IACxBlB,SAAS,EAAEA,SAAS;IACpBC,QAAQ,EAAEA,QAAQ;IAClBC,IAAI,EAAEA,IAAI;IACVG,oBAAoB,EAAEA;EACxB,CAAC,EAAE0D,qBAAqB,EAAEvB,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,WAAW,CAACkG,gBAAgB,EAAElG,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,WAAW,CAACmG,eAAe,CAAC,CAAC,EAAEzH,IAAI,KAAK,MAAM,KAAKsB,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,WAAW,CAAC4D,YAAY,CAAC,IAAI,aAAahL,KAAK,CAACkL,aAAa,CAACjJ,YAAY,EAAE;IACnWuL,OAAO,EAAEpG,WAAW,CAAC4D;EACvB,CAAC,CAAC,EAAElF,IAAI,KAAK,SAAS,IAAI,aAAa9F,KAAK,CAACkL,aAAa,CAAC1K,GAAG,EAAE;IAC9DuD,EAAE,EAAE;MACF0J,CAAC,EAAE,CAAC;MACJC,QAAQ,EAAE,MAAM;MAChBlC,MAAM,EAAE3H,UAAU,GAAG,MAAM,GAAGmC,SAAS;MACvC2H,SAAS,EAAE7G,WAAW,CAACT,OAAO;MAC9BuH,SAAS,EAAE;IACb,CAAC;IACD,WAAW,EAAE,QAAQ;IACrBC,QAAQ,EAAE,CAAC;EACb,CAAC,EAAE,aAAa7N,KAAK,CAACkL,aAAa,CAAC,IAAI,EAAE;IACxCE,KAAK,EAAEnI;EACT,CAAC,EAAE,2BAA2B,CAAC,EAAE,aAAajD,KAAK,CAACkL,aAAa,CAACrK,cAAc,EAAE;IAChFiN,qBAAqB,EAAE;MACrBC,MAAM,EAAE9H,IAAI,IAAI;IAClB,CAAC;IACD+H,OAAO,EAAE/H,IAAI,KAAK,IAAI;IACtBgI,iBAAiB,EAAE;EACrB,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC5I,aAAa,GAAGC,KAAK,CAACK,MAAM,MAAM,IAAI,IAAIN,aAAa,KAAK,KAAK,CAAC,GAAGA,aAAa,GAAG,aAAarF,KAAK,CAACkL,aAAa,CAAC3J,UAAU,EAAE,IAAI,EAAE,aAAavB,KAAK,CAACkO,cAAc,CAAC5I,KAAK,CAACG,OAAO,CAAC,IAAIH,KAAK,CAACG,OAAO,CAAC0I,KAAK,CAACpJ,QAAQ,CAAC,CAAC,CAAC,CAAC;AACrO,CAAC,CAAC;AAEF,SAASzB,cAAc,IAAI8K,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}